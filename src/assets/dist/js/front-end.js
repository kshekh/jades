function login(route,token,email,password,checkout=false){$.ajaxSetup({headers:{'X-CSRF-TOKEN':token}});$.ajax({type:"POST",url:route,data:{email,password,},dataType:'json',success:function(data,textStatus,jqXHR){if(checkout){return document.location.href="/checkout"}else{return document.location.href="/profile"}},error:function(data){console.log('error',data);$('.invalid-feedback--login').html(`${data.responseJSON.message}`).attr("style","display:block; color: red; padding-bottom: 15px")}});}
function register(route,token,name,sure_name,phone,email,password,password_confirmation){$.ajaxSetup({headers:{'X-CSRF-TOKEN':token}});$.ajax({type:"POST",url:route,data:{name,sure_name,phone,email,password,password_confirmation},dataType:'json',success:function(data,textStatus,jqXHR){document.location.href="/thank-you"},error:function(data){if(data.status===201){document.location.href="/thank-you"}
console.log('error',data);console.log('error',data.responseJSON.errors.email);if(data.responseJSON.errors.email){$('.invalid-feedback--email').html(`${data.responseJSON.errors.email}`).attr("style","display:block; color: red; padding-bottom: 15px")}
if(data.responseJSON.errors.name){$('.invalid-feedback--name').html(`${data.responseJSON.errors.name}`).attr("style","display:block; color: red; padding-bottom: 15px")}
if(data.responseJSON.errors.sure_name){$('.invalid-feedback--sure_name').html(`${data.responseJSON.errors.sure_name}`).attr("style","display:block; color: red; padding-bottom: 15px")}
if(data.responseJSON.errors.password){$('.invalid-feedback--password').html(`${data.responseJSON.errors.password}`).attr("style","display:block; color: red; padding-bottom: 15px")}}});}
function loadProduct(paged){if(paged){$.ajax({type:"GET",url:`?page=${parseInt(paged)+1}`,dataType:'html',beforeSend:function(){$('.js-infinity-scroll').addClass('active');},success:function(data,textStatus,jqXHR){$('.js-append-to').append(data);$('.js-infinity-scroll').removeClass('active');},error:function(data){console.log('error',data);}});}}
function loadPromotions(paged){$.ajax({type:"GET",url:`?page=${parseInt(paged)+1}`,dataType:'html',beforeSend:function(){$('.js-infinity-scroll').addClass('active');},success:function(data,textStatus,jqXHR){$('.js-append-to').append(data);$('.js-infinity-scroll').removeClass('active');},error:function(data){console.log('error',data);}});}
function addWishList(data,token,id=null){$.ajaxSetup({headers:{'X-CSRF-TOKEN':token}});$.ajax({type:"post",dataType:"json",url:"/wishlist/post",data,success:function(res){console.log('res wishlist ==>',res);if(res.status===2000){const data={color_ids:res.color_ids,user_id:res.user_id,products:res.products,wish_list_id:res.wishlist_id,product_ids:res.product_ids,};Cookies.set('wishList',JSON.stringify(data));Cookies.set('user_id_fuji_link',res.user_id);$('.badge--wish_list').css('display','flex').text(res.total);if(id){$(`button#button-${id}`).attr('data-buttonId',res.wishlist_id);}}
if(res.status===4000){$('#error_wishlist').modal({fadeDuration:1000,fadeDelay:0.3,showClose:false});}}});}
function removeWishlist(id){$.ajaxSetup({headers:{'X-CSRF-TOKEN':token}});$.ajax({type:"put",dataType:"json",url:`/wishlist/put`,data:{id},success:function(res){if(res.status===2000){$('#product-item--wishlist-'+id).remove();const data={color_ids:res.color_ids,user_id:res.user_id,products:res.products,product_ids:res.product_ids,};Cookies.set('wishList',JSON.stringify(data));Cookies.set('user_id_fuji_link',res.user_id);if(res.total===0){$('.badge--wish_list').css('display','none');$('.bar__sub-title').text(`(0 items)`);}else{$('.badge--wish_list').css('display','flex').text(res.total);$('.bar__sub-title').text(`(${res.total} items)`);}}}});}
function update_cart(cart_id,lang){const qty=$('.amount-total').val();const coupon=$('.coupon_code').val();let data={cart_id,qty,lang};if(coupon!==null&&coupon){data={cart_id,qty,lang,coupon}}
const token=$('meta[name="csrf-token"]').attr('content');$.ajaxSetup({headers:{'X-CSRF-TOKEN':token}});$.ajax({type:"put",dataType:"json",url:`/cart/put`,data,success:function(res){console.log('res data cart',res);if(res.status===2000){Cookies.set('carts_fuji_link',JSON.stringify(res.data));Cookies.set('user_id_fuji_link',res.user_id);if(res.total===0){$('.badge--badge--cart').css('display','none');}else{$('.badge--badge--cart').css('display','flex').text(res.total);$('span.carts-bar.bar__sub-title').text(`(${res.total} items)`);}
location.reload();}}});}
function update_discount(cart_id,lang){const qty=$('.amount-total').val();const coupon=$('.coupon_code').val();let data={cart_id,qty,lang};const total_first=$('#total').val();if(coupon!==null&&coupon){data={cart_id,qty,lang,coupon};const token=$('meta[name="csrf-token"]').attr('content');$.ajaxSetup({headers:{'X-CSRF-TOKEN':token}});$.ajax({type:"put",dataType:"json",url:`/cart/coupon`,data,beforeSend:function(){$('span.invalid-feedback.invalid-feedback--coupon_code').css("display","none");},success:function(res){console.log('res data coupon',res);if(res.status===2000){const discount=res.discount;console.log(res.type);if(res.type==='product'){$('tr.has-discount').css('display','table-row');$('.has-discount-shipping').css('display','none');$('.discount-shipping').css('display','none');$('#discountName').text(`DISCOUNT (${res.code})`);$('#discount-shipping-name').text(``);$('#discount').text(`-Â¥${parseInt(discount).toLocaleString()}`);$('#discount-shipping').text(``);$('#subtotal_with_code_text').text('SUBTOTAL WITH CODE USAGE');$('#subtotal-with-code-shipping-text').text('');$('#subtotal_with_code').text(`Â¥${parseInt(res.total-discount).toLocaleString()}`);$('#total-cart').text(`Â¥${parseInt((res.total-discount)+(res.total-100)*0.1+500).toLocaleString()}`);Cookies.set('discount_fuji_link',discount);Cookies.set('code_discount_fuji_link',res.code);Cookies.set('code_type_discount_fuji_link',res.type);}
if(res.type==="shipping"){$('tr.has-discount').css('display','none');$('.has-discount-shipping').css('display','table-row');$('.discount-shipping').css('display','table-row');$('#discount-shipping-name').text(`DELIVERY DISCOUNT (${res.code})`);$('#discountName').text(``);$('#discount-shipping').text(`- Â¥${parseInt(discount).toLocaleString()}`);$('#discount').text(``);$('#subtotal-with-code-shipping-text').text('DELIVERY FEE WITH CODE USAGE');$('#subtotal_with_code_text').text('');$('#subtotal-with-code-shipping-code').text(`Â¥${parseInt(500-discount).toLocaleString()}`);$('#total-cart').text(`Â¥${(((parseInt(res.total)+parseInt(res.total)*0.1)+500)-discount).toLocaleString()}`);Cookies.set('discount_fuji_link',discount);Cookies.set('code_discount_fuji_link',res.code);Cookies.set('code_type_discount_fuji_link',res.type);}}
else{$('#discountName').text(' ');$('#discount').text(' ');$('#subtotal_with_code_text').text(' ');$('#subtotal_with_code').text(` `);$('span.invalid-feedback.invalid-feedback--coupon_code').text(res.msg).css("display","block");}}});}}
function updateQtyCart(qty,sku,coupon,lang,id){$.ajaxSetup({headers:{'X-CSRF-TOKEN':token}});$.ajax({type:"put",dataType:"json",url:`/cart/update-qty`,data:{qty,sku,lang,coupon},beforeSend:function(){$('.loading').addClass('active');},success:function(res){$('.loading').removeClass('active');console.log(res);if(res.status===2000){if(res.hasDiscount){const discount=res.discount;if(res.type==='product'){$('tr.has-discount').css('display','table-row');$('.has-discount-shipping').css('display','none');$('.discount-shipping').css('display','none');$('#discount-shipping-name').text(``);$('#discountName').text(`DISCOUNT (${res.code})`);$('#discount').text(`- Â¥${(discount).toLocaleString()}`);$('#subtotal_with_code_text').text('SUBTOTAL WITH CODE USAGE');$('#subtotal_with_code').text(`Â¥${parseInt(res.total-discount).toLocaleString()}`);$('#total-cart').text(`Â¥${parseInt((res.total-discount)+(res.total-100)*0.1+500).toLocaleString()}`);$('#discount-total').text(`Â¥${(parseInt(res.total).toLocaleString())}`);$('input#total').val(parseInt(res.total));$('input#total-discount').val(parseInt(res.total));$('#discount-shipping').text(``);$('#subtotal-with-code-shipping-text').text('');}
if(res.type==="shipping"){$('tr.has-discount').css('display','none');$('.has-discount-shipping').css('display','table-row');$('.discount-shipping').css('display','table-row');$('#discountName').text(``);$('#discount').text(``);$('#discount-shipping-name').text(`DELIVERY DISCOUNT (${res.code})`);$('#discount-shipping').text(`- Â¥${parseInt(discount).toLocaleString()}`);$('#subtotal-with-code-shipping-text').text('DELIVERY FEE WITH CODE USAGE');$('#subtotal-with-code-shipping-code').text(`Â¥${parseInt(500-discount).toLocaleString()}`);$('#total-cart').text(`Â¥${(((parseInt(res.total)+parseInt(res.total)*0.1)+500)-discount).toLocaleString()}`);$('input#total').val(parseInt(res.total));$('input#total-discount').val(parseInt(res.total));$('#discount-total').text(`Â¥${(parseInt(res.total).toLocaleString())}`);$('#subtotal_with_code_text').text('');}}else{$('#discount-total').text(`Â¥${(parseInt(res.total).toLocaleString())}`);$('#total-cart').text(`Â¥${(parseInt(res.total)+500+res.total_tax).toLocaleString()}`);$('input#total').val(parseInt(res.total));$('input#total-discount').val(parseInt(res.total));}}}});}
function removeCart(id){const token=$('meta[name="csrf-token"]').attr('content');$.ajaxSetup({headers:{'X-CSRF-TOKEN':token}});$.ajax({type:"put",dataType:"json",url:`/cart/delete`,data:{id},success:function(res){if(res.status===2000){if(res.total_items==0){Cookies.set('carts_fuji_link',null);$('.badge.badge--cart').css('display','none');window.location.href='/home'}else{$('.badge.badge--cart').css('display','flex').text(res.total_items);$('span.carts-bar.bar__sub-title').text(`(${res.total_items} items)`);$('#discount-total').text(`Â¥${(parseInt(res.total)).toLocaleString()}`);$('#total-cart').text(`$Â¥${(parseInt(res.total)+500+10).toLocaleString()}`);}
$('tr#item-'+id).remove();}}});}
function shippingCheckout(){const token=$('meta[name="csrf-token"]').attr('content');const sure_name=$('#surname').val();const name=$('#name').val();const sure_name_2=$('#surname_2').val();const first_name=$('#first_name').val();const company=$('#company').val();const country=$('#country').val();const prefectures=$('#prefectures').val();const city=$('#city').val();const street_address=$('#street_address').val();const postal_code=$('#postal_code').val();const is_default=$('input[name="is_default"]:checked').val();const data={sure_name,name,sure_name_2,first_name,company,country,prefectures,city,is_default,street_address,postal_code};$.ajaxSetup({headers:{'X-CSRF-TOKEN':token}});$.ajax({type:"post",dataType:"json",url:`/profile/shipping`,data,beforeSend:function(){$('span.invalid-feedback').html('');},success:function(res){if(res.status===2000){console.log(res);}},error:function(data){if(data.responseJSON.errors.sure_name_2){$('span.invalid-feedback.invalid-feedback--surname_2').html(`${data.responseJSON.errors.sure_name_2}`).attr("style","display:block; color: red; padding-bottom: 15px")}
if(data.responseJSON.errors.sure_name){$('span.invalid-feedback.invalid-feedback--sure_name').html(`${data.responseJSON.errors.sure_name}`).attr("style","display:block; color: red; padding-bottom: 15px")}
if(data.responseJSON.errors.name){$('span.invalid-feedback.invalid-feedback--name').html(`${data.responseJSON.errors.name}`).attr("style","display:block; color: red; padding-bottom: 15px")}
if(data.responseJSON.errors.first_name){$('span.invalid-feedback.invalid-feedback--first_name').html(`${data.responseJSON.errors.first_name}`).attr("style","display:block; color: red; padding-bottom: 15px")}
if(data.responseJSON.errors.prefectures){$('span.invalid-feedback.invalid-feedback--prefectures').html(`${data.responseJSON.errors.prefectures}`).attr("style","display:block; color: red; padding-bottom: 15px")}
if(data.responseJSON.errors.city){$('span.invalid-feedback.invalid-feedback--city').html(`${data.responseJSON.errors.city}`).attr("style","display:block; color: red; padding-bottom: 15px")}
if(data.responseJSON.errors.street_address){$('span.invalid-feedback.invalid-feedback--street_address').html(`${data.responseJSON.errors.street_address}`).attr("style","display:block; color: red; padding-bottom: 15px")}}});}
function receiptCheckout(){const token=$('meta[name="csrf-token"]').attr('content');const is_shipping=$('input[name="is_shipping"]:checked').val();$.ajaxSetup({headers:{'X-CSRF-TOKEN':token}});if(is_shipping==='check'){const sure_name=$('#surname').val();const name=$('#name').val();const sure_name_2=$('#surname_2').val();const country=$('#country').val();const prefectures=$('#prefectures').val();const city=$('#city').val();const street_address=$('#street_address').val();const postal_code=$('#postal_code').val();const is_default=$('input[name="is_receipt_default"]:checked').val();const data={sure_name,name,sure_name_2,country,prefectures,city,is_default,street_address,postal_code};$.ajax({type:"post",dataType:"json",url:`/profile/receipt`,data,success:function(res){if(res.status===2000){console.log(res);}},});}
else{const sure_name=$('#surename_receipt').val();const name=$('#name_receipt').val();const sure_name_2=$('#surename_receipt_2').val();const country=$('#country_receipt').val();const prefectures=$('#prefectures_receipt').val();const city=$('#city_receipt').val();const street_address=$('#street_address_receipt').val();const postal_code=$('#postal_code_receipt').val();const is_default=$('input[name="is_receipt_default"]:checked').val();const data={sure_name,name,sure_name_2,country,prefectures,city,is_default,street_address,postal_code};$.ajax({type:"post",dataType:"json",url:`/profile/receipt`,data,success:function(res){if(res.status===2000){console.log(res);}},error:function(data){console.log('dfsfsdfs');if(data.responseJSON.errors.sure_name){$('span.invalid-feedback.invalid-feedback--surename_receipt').html(`${data.responseJSON.errors.sure_name}`).attr("style","display:block; color: red; padding-bottom: 15px")}
if(data.responseJSON.errors.name){$('span.invalid-feedback.invalid-feedback--name_receipt').html(`${data.responseJSON.errors.name}`).attr("style","display:block; color: red; padding-bottom: 15px")}
if(data.responseJSON.errors.sure_name_2){$('span.invalid-feedback.invalid-feedback--surename_receipt_2').html(`${data.responseJSON.errors.sure_name_2}`).attr("style","display:block; color: red; padding-bottom: 15px")}
if(data.responseJSON.errors.city){$('span.invalid-feedback.invalid-feedback--city_receipt').html(`${data.responseJSON.errors.city}`).attr("style","display:block; color: red; padding-bottom: 15px")}
if(data.responseJSON.errors.street_address){$('span.invalid-feedback.invalid-feedback--street_address_receipt').html(`${data.responseJSON.errors.street_address}`).attr("style","display:block; color: red; padding-bottom: 15px")}
if(data.responseJSON.errors.prefectures){$('span.invalid-feedback.invalid-feedback--prefectures_receipt').html(`${data.responseJSON.errors.prefectures}`).attr("style","display:block; color: red; padding-bottom: 15px")}}});}}
function sendResetPassword(route,token,email){$('.alert.forget_email.alert-success').text('');$('.alert.forget_email.alert-error').text('');$.ajaxSetup({headers:{'X-CSRF-TOKEN':token}});$.ajax({type:"POST",url:route,data:{email},dataType:'json',success:function(data,textStatus,jqXHR){$('.alert.forget_email.alert-success').text(data['msg']);$('input#forget_email').val(' ');},error:function(data,exception){if(data.status===404){console.log(data);$('.alert.forget_email.alert-error').html(`${data.responseJSON.email}`).attr("style","display:block; color: red; padding-bottom: 15px")}else{$('.alert.forget_email.alert-error').html(`${data.responseJSON.errors.email}`).attr("style","display:block; color: red; padding-bottom: 15px")}},});}
function resetPassword(route,token,email,password,password_confirmation,token_reset_password){$('.alert.reset_password.alert-success').text('');$('.alert.reset_password.alert-error').text('');$.ajaxSetup({headers:{'X-CSRF-TOKEN':token}});$.ajax({type:"POST",url:route,data:{email,password,password_confirmation,'token':token_reset_password,},dataType:'json',success:function(data,textStatus,jqXHR){$("#formResetPassword")[0].reset();$('input#email_reset_pasword').val(' ');$('.alert.reset_password.alert-success').text(data['msg']);},error:function(data,exception){if(data.status===400){$('.alert.reset_password.alert-error').html(`${data.responseJSON.msg}`).attr("style","display:block; color: red; padding-bottom: 15px")}else{$('.alert.reset_password.alert-error').html(`${data.responseJSON.errors.password}`).attr("style","display:block; color: red; padding-bottom: 15px")}},});}
function myAddress(){const token=$('meta[name="csrf-token"]').attr('content');const sure_name=$('#sure_name').val();const name=$('#name').val();const sure_name_2=$('#sure_name_2').val();const first_name=$('#first_name').val();const company=$('#company').val();const country=$('#country').val();const street_address=$('#street_address').val();const state=$('#state').val();const prefectures=$('#prefectures').val();const city=$('#city').val();const postal_code=$('#postal_code').val();const receipt=$('input[name="receipt1"]:checked').val();const shipping=$('input[name="shipping1"]:checked').val();const data={sure_name,name,sure_name_2,first_name,company,country,prefectures,city,street_address,postal_code,receipt,shipping,};$.ajaxSetup({headers:{'X-CSRF-TOKEN':token}});$.ajax({type:"post",dataType:"json",url:`/my-address/store`,data,beforeSend:function(){$('span.invalid-feedback').html('');},success:function(res){if(res.status===200){location.reload();}},error:function(data){if(data.responseJSON.errors.sure_name){$('span.invalid-feedback.invalid-feedback--sure_name').html(`${data.responseJSON.errors.sure_name}`).attr("style","display:block; color: red; padding-bottom: 15px")}
if(data.responseJSON.errors.name){$('span.invalid-feedback.invalid-feedback--name').html(`${data.responseJSON.errors.name}`).attr("style","display:block; color: red; padding-bottom: 15px")}
if(data.responseJSON.errors.sure_name_2){$('span.invalid-feedback.invalid-feedback--sure_name_2').html(`${data.responseJSON.errors.sure_name_2}`).attr("style","display:block; color: red; padding-bottom: 15px")}
if(data.responseJSON.errors.first_name){$('span.invalid-feedback.invalid-feedback--first_name').html(`${data.responseJSON.errors.first_name}`).attr("style","display:block; color: red; padding-bottom: 15px")}
if(data.responseJSON.errors.country){$('span.invalid-feedback.invalid-feedback--country').html(`${data.responseJSON.errors.country}`).attr("style","display:block; color: red; padding-bottom: 15px")}
if(data.responseJSON.errors.prefectures){$('span.invalid-feedback.invalid-feedback--prefectures').html(`${data.responseJSON.errors.prefectures}`).attr("style","display:block; color: red; padding-bottom: 15px")}
if(data.responseJSON.errors.city){$('span.invalid-feedback.invalid-feedback--city').html(`${data.responseJSON.errors.city}`).attr("style","display:block; color: red; padding-bottom: 15px")}
if(data.responseJSON.errors.street_address){$('span.invalid-feedback.invalid-feedback--street_address').html(`${data.responseJSON.errors.street_address}`).attr("style","display:block; color: red; padding-bottom: 15px")}
if(data.responseJSON.errors.postal_code){$('span.invalid-feedback.invalid-feedback--postal_code').html(`${data.responseJSON.errors.postal_code}`).attr("style","display:block; color: red; padding-bottom: 15px")}
if(data.responseJSON.errors.receipt){$('span.invalid-feedback.invalid-feedback--checkbox').html(`${data.responseJSON.errors.receipt}`).attr("style","display:block; color: red; padding-bottom: 15px")}
if(data.responseJSON.errors.shipping){$('span.invalid-feedback.invalid-feedback--checkbox').html(`${data.responseJSON.errors.shipping}`).attr("style","display:block; color: red; padding-bottom: 15px")}}});}
function getDetailProductBySku(sku,isColor=false){$.ajax({type:"GET",dataType:"json",url:`/api/product/${sku}/detail`,beforeSend:function(){$('.loading').addClass('active');},success:function(res){$('.loading').removeClass('active');if(res.status===200&&res.data){$('#max-stock').val(res.data.stock);if(res.data.stock>0){$('#amount').val(1).attr("data-max",res.data.stock).attr('maxlength',res.data.stock);}
if(isColor){if(res.galleryDesktop||res.galleryDesktop!==''){$('.product-detail-slider.slider-for').html(res.galleryDesktop);$('.product-detail-slider.slider-nav').html(res.galleryMobile);}
if(res.coverThumbnail){$('.product__image').html(res.coverThumbnail);}
if(res.color){$('#product_size').html(res.color)}
if(res.data){if(res.data.is_sale_price){$('#content-price').html(`<p id="salePrice">Â¥${parseInt(res.data.sale_price).toLocaleString()}</p><span id="regularPrice" class="product-item__sale">Â¥${parseInt(res.data.regular_price).toLocaleString()}</span>`);$('#salePriceModel').text(`Â¥${parseInt(res.data.sale_price).toLocaleString()}`)}
else{$('#content-price').html(`<p id="salePrice">Â¥${parseInt(res.data.regular_price).toLocaleString()}</p>`);$('#salePriceModel').text(null);$('#regularPriceModel').removeClass('product-item__sale').text(`Â¥${parseInt(res.data.regular_price).toLocaleString()}`)}}}else{if(res.data){if(res.data.is_sale_price){$('#content-price').html(`<p id="salePrice">Â¥${parseInt(res.data.sale_price).toLocaleString()}</p><span id="regularPrice" class="product-item__sale">Â¥${parseInt(res.data.regular_price).toLocaleString()}</span>`)}
else{$('#content-price').html(`<p id="salePrice">Â¥${parseInt(res.data.regular_price).toLocaleString()}</p>`)}}}
$('#product_code_sku').text(res.data.sku);}
$('#product_code_sku').attr('data-codeproduct',res.data.sku);$('a.btn.js-open-add-to-car-detail').attr('data-productid',res.data.id);}});}
function updateSku(color_id,size_id){$.ajaxSetup({headers:{'X-CSRF-TOKEN':token}});$.ajax({type:"POST",dataType:"json",url:`/product/sku`,data:{color_id,size_id},beforeSend:function(){$('.loading').addClass('active');},success:function(res){$('.loading').removeClass('active');if(res.status===2000){$('#product_code_sku').text(res.sku);$('.product-code').text(res.sku).attr('data-codeproduct',res.sku)}}});}
function addToCart(product_id,master_product_id,sku,qty,size_id,color_id){$.ajaxSetup({headers:{'X-CSRF-TOKEN':token}});$.ajax({type:"post",dataType:"json",url:`/cart/post`,data:{product_id,master_product_id,sku,qty,size_id,color_id},success:function(res){if(res.status===2000){Cookies.set('carts_fuji_link',JSON.stringify(res.data));Cookies.set('user_id_fuji_link',res.user_id);if(res.total===0){$('.badge--badge--cart').css('display','none');}else{$('span.badge.badge--cart').css('display','flex').text(res.total);$('span.carts-bar.bar__sub-title').text(`(${res.total} items)`);}
$('#add-to-car').modal({fadeDuration:1000,fadeDelay:0.3,showClose:false});}
else if((res.status===4005))
{console.log('error')}}});}